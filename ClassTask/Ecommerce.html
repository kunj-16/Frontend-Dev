<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>E-Commerce Dashboard</title>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <style>
      body {
        font-family: Arial;
        padding: 20px;
        background: #f5f5f5;
      }

      h1 {
        text-align: center;
      }

      button {
        padding: 10px 20px;
        margin: 10px 5px;
        cursor: pointer;
        background: #007bff;
        border: none;
        color: white;
        border-radius: 5px;
      }

      #productList {
        margin-top: 20px;
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 15px;
      }

      .product {
        background: white;
        border-radius: 8px;
        padding: 15px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        transition: 0.3s;
      }

      .product.active {
        border: 2px solid #28a745;
        background: #e8ffe8;
      }

      .description {
        color: #555;
        display: none;
      }

      /* Popup Modal */
      #modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        justify-content: center;
        align-items: center;
      }

      #modalContent {
        background: white;
        padding: 20px;
        width: 300px;
        border-radius: 8px;
      }

      input {
        width: 100%;
        padding: 8px;
        margin: 8px 0;
      }
    </style>
  </head>
  <body>
    <h1>E-Commerce Product Dashboard</h1>

    <button id="loadProducts">Load Products (AJAX GET)</button>
    <button id="openModal">Add New Product</button>

    <div id="productList"></div>

    <!-- Add Product Popup -->
    <div id="modal">
      <div id="modalContent">
        <h3>Add New Product</h3>
        <input type="text" id="prodName" placeholder="Product Name" />
        <input type="number" id="prodPrice" placeholder="Price" />
        <button id="saveProduct">Save Product</button>
        <button id="closeModal" style="background:red;">Close</button>
      </div>
    </div>

    <script>
      let userProducts = []; // manually add products

      function renderProducts(products) {
        $("#productList").empty();

        // Render API products
        products.forEach(p => {
          $("#productList").append(`
            <div class="product" data-stock="10">
              <h3>${p.title}</h3>
              <p class="description">${p.description || ""}</p>
              <p>Price: $${p.price}</p>
            </div>
          `);
        });

        // Render User Added Products
        userProducts.forEach(p => {
          $("#productList").prepend(`
            <div class="product" data-stock="20">
              <h3>${p.title}</h3>
              <p class="description">${p.description}</p>
              <p>Price: $${p.price}</p>
            </div>
          `);
        });
      }

      $("#loadProducts").click(function () {
        $.get("https://fakestoreapi.com/products", function (products) {
          renderProducts(products);
        });
      });

      $("#openModal").click(() => $("#modal").css("display", "flex"));
      $("#closeModal").click(() => $("#modal").hide());

      // Save new product
      $("#saveProduct").click(function () {
        let name = $("#prodName").val();
        let price = $("#prodPrice").val();

        if (name === "" || price === "") {
          alert("Please fill all fields");
          return;
        }

        userProducts.unshift({
          title: name,
          price: price,
          description: "Custom User Added Product"
        });

        $("#modal").hide();
        $("#prodName").val("");
        $("#prodPrice").val("");

        renderProducts([]); // re-render only user products
      });

      // Hover effect
      $(document).on("mouseenter", ".product", function () {
        $(this).find(".description").slideDown();
      });

      $(document).on("mouseleave", ".product", function () {
        $(this).find(".description").slideUp();
      });
    </script>
  </body>
</html>
